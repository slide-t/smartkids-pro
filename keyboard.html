<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<title>SmartKids Pro: Keyboard Tutor</title>
<style>
  body {
    font-family: 'Poppins', sans-serif;
    background: #0f172a;
    color: #fff;
    min-height: 100vh;
    display: flex;
    flex-direction: column;
    align-items: center;
    padding: 1rem;
  }

  h1 {
    font-size: 1.75rem;
    font-weight: 700;
    margin-bottom: 0.75rem;
    text-align: center;
  }

  .controls {
    display: flex;
    flex-wrap: wrap;
    justify-content: center;
    gap: 0.5rem;
    margin-bottom: 1rem;
  }

  select, button {
    background: #1e293b;
    color: #fff;
    border: none;
    border-radius: 0.4rem;
    padding: 0.5rem 0.9rem;
    font-size: 0.9rem;
    cursor: pointer;
    transition: background 0.3s ease;
  }

  button:hover {
    opacity: 0.9;
  }

  #musicToggle { background-color: #db2777; }
  #startBtn { background-color: #2563eb; }
  #pauseBtn { background-color: #facc15; color: #000; }

  /* Stats & Progress */
  .stats {
    width: 100%;
    max-width: 500px;
    text-align: center;
  }

  .stat-line {
    display: flex;
    justify-content: space-between;
    font-size: 0.85rem;
    margin-bottom: 0.25rem;
  }

  .progress-bar {
    width: 100%;
    background: #334155;
    height: 0.5rem;
    border-radius: 9999px;
    margin-bottom: 1.5rem;
    overflow: hidden;
  }

  #progressInner {
    background-color: #22c55e;
    height: 100%;
    width: 0%;
    border-radius: 9999px;
    transition: width 0.4s ease;
  }

  /* Word Display */
  #wordDisplay {
    text-align: center;
    font-size: 2rem;
    font-weight: 600;
    letter-spacing: 0.15em;
    margin-bottom: 1.5rem;
    word-wrap: break-word;
  }

  .tile {
    display: inline-block;
    margin: 0 4px;
    padding: 6px 10px;
    font-size: 1.5rem;
    background: #1e293b;
    border-radius: 0.4rem;
    color: #fff;
    opacity: 0;
    transform: translateY(-30px);
    animation: dropIn 0.5s ease forwards;
  }

  @keyframes dropIn {
    0% { opacity: 0; transform: translateY(-40px); }
    100% { opacity: 1; transform: translateY(0); }
  }

  .tile.correct { background-color: #22c55e; }
  .tile.wrong { background-color: #ef4444; }

  /* Input & Feedback */
  #inputBox {
    background: #1e293b;
    border: 2px solid #334155;
    border-radius: 0.5rem;
    padding: 0.75rem;
    font-size: 1.1rem;
    text-align: center;
    color: #fff;
    width: 75%;
    max-width: 280px;
    margin-bottom: 0.75rem;
    outline: none;
  }

  #feedback {
    font-size: 1rem;
    text-align: center;
    margin-bottom: 0.25rem;
  }

  #scoreboard {
    font-size: 0.85rem;
    color: #94a3b8;
    text-align: center;
    margin-bottom: 1rem;
  }

  @media (max-width: 480px) {
    h1 { font-size: 1.4rem; }
    #wordDisplay { font-size: 1.5rem; }
    select, button { font-size: 0.8rem; padding: 0.4rem 0.7rem; }
    .controls { flex-direction: column; align-items: center; }
  }
</style>
</head>

<body>
  <h1>SmartKids Pro: Keyboard Tutor</h1>

  <div class="controls">
    <select id="yearSelect">
      <option value="">Select Year</option>
    </select>
    <button id="startBtn">Start</button>
    <button id="pauseBtn">‚è∏ Pause</button>
    <button id="musicToggle">üîä Music On</button>
  </div>

  <!-- Stats -->
  <div class="stats">
    <div class="stat-line">
      <span>Timer: <span id="timer">0</span>s</span>
      <span>WPM: <span id="wpm">0</span></span>
      <span>Progress: <span id="progressCount">0%</span></span>
    </div>
    <div class="progress-bar">
      <div id="progressInner"></div>
    </div>
  </div>

  <!-- Word Display -->
  <div id="wordDisplay"></div>

  <!-- Input & Feedback -->
  <input id="inputBox" type="text" placeholder="Type here..." class="hidden" />
  <div id="feedback"></div>
  <div id="scoreboard"></div>


<script>
let lessons = {};
let dictionary = [];
let timerInterval = null;
let timeLeft = 0, totalTime = 0;
let score = 0, correct = 0, attempts = 0;
let currentWords = [], currentIndex = 0;
let isPaused = false;

// DOM
const timerEl = document.getElementById('timer');
const wpmEl = document.getElementById('wpm');
const progressEl = document.getElementById('progressInner');
const progressCountEl = document.getElementById('progressCount');
const feedback = document.getElementById('feedback');
const inputBox = document.getElementById('inputBox');
const display = document.getElementById('wordDisplay');
const scoreBoard = document.getElementById('scoreboard');
const startBtn = document.getElementById('startBtn');
const yearSelect = document.getElementById('yearSelect');

// üéµ Audio
const sfx = {
  correct: new Audio('./assets/sfx/correct.mp3'),
  wrong: new Audio('./assets/sfx/wrong.mp3'),
  start: new Audio('./assets/sfx/start.mp3'),
  end: new Audio('./assets/sfx/end.mp3'),
  bgm: new Audio('./assets/music/background.mp3')
};
sfx.bgm.loop = true; sfx.bgm.volume = 0.2;

document.getElementById('musicToggle').addEventListener('click', () => {
  if (sfx.bgm.paused) { sfx.bgm.play(); musicToggle.textContent = 'üîä Music On'; }
  else { sfx.bgm.pause(); musicToggle.textContent = 'üîà Music Off'; }
});

// üéØ Fetch JSON data
fetch("json-files/keyboard_lessons.json")
  .then(res => res.json())
  .then(data => {
    lessons = data;
    Object.keys(data).forEach(year => {
      const opt = document.createElement("option");
      opt.value = year;
      opt.textContent = year;
      yearSelect.appendChild(opt);
    });
  })
  .catch(() => {
    lessons = {
      "Year 1": { "timer": 25, "items": ["cat","dog","sun","map","cup","bed","hat","pen","top","bus"] },
      "Year 2": { "timer": 22, "items": ["play","book","milk","road","hand","fish","frog","door","cake","jump"] },
    };
  });

// üéÆ Start Game
startBtn.addEventListener('click', startSession);
inputBox.addEventListener('input', checkTyping);

function startSession() {
  const selectedYear = yearSelect.value;
  if (!selectedYear) return alert('Select a Year first!');
  
  sfx.start.play(); sfx.bgm.play();

  const lesson = lessons[selectedYear];
  const baseTime = lesson.minLength < 5 ? 30 : 45;
  timeLeft = baseTime;
  totalTime = baseTime;
  correct = 0; score = 0; attempts = 0;
  currentWords = shuffle([...lesson.items]);
  currentIndex = 0;
  feedback.textContent = '';
  inputBox.value = ''; inputBox.classList.remove('hidden'); inputBox.focus();
  showWord();
  updateProgress();

  // Clear and start timer
  clearInterval(timerInterval);
  timerInterval = setInterval(() => {
    if (!isPaused) {
      timeLeft--;
      timerEl.textContent = timeLeft;
      progressEl.style.width = ((timeLeft / totalTime) * 100) + '%';
      if (timeLeft <= 0) endSession();
    }
  }, 1000);
}

function showWord() {
  display.innerHTML = '';
  const word = currentWords[currentIndex];
  if (!word) { currentIndex = 0; shuffle(currentWords); } // Loop words
  const activeWord = currentWords[currentIndex];
  [...activeWord].forEach(ch => {
    const span = document.createElement('span');
    span.textContent = ch;
    span.className = 'tile';
    display.appendChild(span);
  });
}

function checkTyping() {
  const typed = inputBox.value;
  const word = currentWords[currentIndex];
  const tiles = display.querySelectorAll('.tile');

  tiles.forEach((t,i)=>{
    t.classList.remove('correct','wrong');
    if(typed[i]){
      if(typed[i].toLowerCase()===word[i].toLowerCase()) t.classList.add('correct');
      else t.classList.add('wrong');
    }
  });

  if(typed.toLowerCase()===word.toLowerCase()){
    sfx.correct.play();
    correct++; score += word.length;
    inputBox.value = '';
    currentIndex = (currentIndex + 1) % currentWords.length; // loop
    updateWPM();
    showWord();
  }
}

function updateWPM() {
  const elapsed = (totalTime - timeLeft) / 60; // minutes
  const wpm = elapsed > 0 ? (correct / elapsed).toFixed(1) : 0;
  wpmEl.textContent = wpm;
}

function endSession() {
  clearInterval(timerInterval);
  sfx.end.play();
  inputBox.classList.add('hidden');
  feedback.textContent = 'üéâ Great job! Session complete!';
  scoreBoard.textContent = `Words Correct: ${correct}, WPM: ${wpmEl.textContent}`;
}

function updateProgress() {
  const pct = ((currentIndex / currentWords.length) * 100).toFixed(1);
  progressCountEl.textContent = pct + '%';
}

function shuffle(arr) {
  return arr.sort(() => Math.random() - 0.5);
}

// üü° Optional Pause Button
const pauseBtn = document.createElement('button');
pauseBtn.textContent = '‚è∏ Pause';
pauseBtn.className = 'bg-yellow-600 hover:bg-yellow-500 px-3 py-2 rounded ml-2';
startBtn.insertAdjacentElement('afterend', pauseBtn);

pauseBtn.addEventListener('click', () => {
  isPaused = !isPaused;
  pauseBtn.textContent = isPaused ? '‚ñ∂ Resume' : '‚è∏ Pause';
});

</script>





  <!--
<script>
document.addEventListener("DOMContentLoaded", () => {
  const yearSelect = document.getElementById("yearSelect");
  const startBtn = document.getElementById("startBtn");
  const pauseBtn = document.getElementById("pauseBtn");
  const inputBox = document.getElementById("inputBox");
  const wordDisplay = document.getElementById("wordDisplay");
  const timerEl = document.getElementById("timer");
  const wpmEl = document.getElementById("wpm");
  const progressCount = document.getElementById("progressCount");
  const progressInner = document.getElementById("progressInner");
  const feedback = document.getElementById("feedback");
  const scoreboard = document.getElementById("scoreboard");
  const musicToggle = document.getElementById("musicToggle");

  let lessonsData = {};
  let words = [];
  let currentIndex = 0;
  let startTime = 0;
  let timerInterval;
  let timeLeft = 0;
  let isPaused = false;
  let correctCount = 0;
  let totalTyped = 0;
  let wpm = 0;
  let musicPlaying = false;
  let bgMusic;

  // üîä Background music
  function setupMusic() {
    bgMusic = new Audio("https://cdn.pixabay.com/audio/2023/03/02/audio_327b4c1b22.mp3");
    bgMusic.loop = true;
    bgMusic.volume = 0.3;
  }

  musicToggle.addEventListener("click", () => {
    if (!bgMusic) setupMusic();
    musicPlaying = !musicPlaying;
    if (musicPlaying) {
      bgMusic.play();
      musicToggle.textContent = "üîà Music Off";
    } else {
      bgMusic.pause();
      musicToggle.textContent = "üîä Music On";
    }
  });

  // ‚è∏ Pause / Resume
  pauseBtn.addEventListener("click", () => {
    if (!timerInterval) return;
    isPaused = !isPaused;
    pauseBtn.textContent = isPaused ? "‚ñ∂ Resume" : "‚è∏ Pause";
  });

  // üéØ Fetch JSON data
  fetch("json-files/keyboard_lessons.json")
    .then(res => res.json())
    .then(data => {
      lessonsData = data;
      Object.keys(data).forEach(year => {
        const opt = document.createElement("option");
        opt.value = year;
        opt.textContent = year;
        yearSelect.appendChild(opt);
      });
    })
    .catch(err => console.error("Error loading JSON:", err));

  // üèÅ Start Game
  startBtn.addEventListener("click", () => {
    const selectedYear = yearSelect.value;
    if (!selectedYear) {
      alert("Please select a year to start.");
      return;
    }

    const lesson = lessonsData[selectedYear];
    words = lesson.items.sort(() => Math.random() - 0.5);
    currentIndex = 0;
    correctCount = 0;
    totalTyped = 0;
    wpm = 0;

    // ‚è± timer based on year (adjustable)
    let baseTime = selectedYear.startsWith("Year 1") ? 15 : 
                   selectedYear.startsWith("Year 2") ? 20 :
                   selectedYear.startsWith("Year 3") ? 25 : 30;
    timeLeft = baseTime;
    timerEl.textContent = timeLeft;

    progressInner.style.width = "0%";
    progressCount.textContent = "0%";
    wpmEl.textContent = "0";
    feedback.textContent = "";
    scoreboard.textContent = "";
    inputBox.classList.remove("hidden");
    inputBox.value = "";
    inputBox.focus();

    startTime = Date.now();
    if (timerInterval) clearInterval(timerInterval);
    timerInterval = setInterval(updateTimer, 1000);

    showWord();
  });

  // üß© Show a word with animation
  function showWord() {
    if (currentIndex >= words.length) {
      endGame();
      return;
    }
    wordDisplay.innerHTML = "";
    const word = words[currentIndex];
    [...word].forEach((letter, i) => {
      const span = document.createElement("span");
      span.className = "tile";
      span.textContent = letter;
      span.style.animationDelay = `${i * 0.08}s`;
      wordDisplay.appendChild(span);
    });
    inputBox.value = "";
    feedback.textContent = "";
  }

  // üí¨ Input logic
  inputBox.addEventListener("input", () => {
    const word = words[currentIndex];
    const typed = inputBox.value.trim();

    totalTyped++;
    if (typed === word) {
      correctCount++;
      playSound("correct");
      feedback.textContent = "‚úÖ Correct!";
      feedback.style.color = "#22c55e";
      nextWord();
    } else if (!word.startsWith(typed)) {
      playSound("error");
      feedback.textContent = "‚ùå Try again...";
      feedback.style.color = "#ef4444";
    }
    updateWPM();
  });

  // ‚è© Move to next word
  function nextWord() {
    currentIndex++;
    const progress = Math.floor((currentIndex / words.length) * 100);
    progressInner.style.width = `${progress}%`;
    progressCount.textContent = `${progress}%`;

    if (currentIndex < words.length) {
      setTimeout(showWord, 600);
    } else {
      endGame();
    }
  }

  // ‚è≤ Update Timer
  function updateTimer() {
    if (isPaused) return;
    if (timeLeft <= 0) {
      endGame();
      return;
    }
    timeLeft--;
    timerEl.textContent = timeLeft;
  }

  // üßÆ Calculate WPM correctly
  function updateWPM() {
    const elapsedMinutes = (Date.now() - startTime) / 60000;
    wpm = Math.round((correctCount / elapsedMinutes) || 0);
    wpmEl.textContent = wpm;
  }

  // üîö End game
  function endGame() {
    clearInterval(timerInterval);
    inputBox.classList.add("hidden");
    feedback.textContent = "";
    wordDisplay.textContent = "üéâ Great job!";
    scoreboard.innerHTML = `
      <p>‚úÖ Correct words: ${correctCount}</p>
      <p>‚è± WPM: ${wpm}</p>
      <p>üìä Accuracy: ${Math.round((correctCount / totalTyped) * 100 || 0)}%</p>
    `;
  }

  // üéµ Sound Effects
  function playSound(type) {
    let url;
    if (type === "correct") url = "https://cdn.pixabay.com/audio/2022/03/15/audio_3a2dcf17de.mp3";
    if (type === "error") url = "https://cdn.pixabay.com/audio/2022/03/15/audio_43fa90b3b1.mp3";
    const sound = new Audio(url);
    sound.volume = 0.5;
    sound.play();
  }
});
</script>
 
  
  
  
  <!--<script>
  // ------------------ Data (Fallback + Fetch) ------------------
  let lessons = {};
  let dictionary = [];

  async function loadData() {
    try {
      const res = await fetch('./json-files/keyboard_lessons.json');
      lessons = await res.json();
    } catch {
      lessons = {
        "Year 1": { "timer": 25, "items": ["cat","dog","sun","map","cup","bed","hat","pen","top","bus"] },
        "Year 2": { "timer": 22, "items": ["play","book","milk","road","hand","fish","frog","door","cake","jump"] },
        "Year 7": { "timer": 20, "items": ["A stitch in time saves nine.","Early to bed, early to rise.","The quick brown fox jumps over the lazy dog."] }
      };
    }

    try {
      const d = await fetch('./json-files/dictionary.json');
      dictionary = await d.json();
    } catch { dictionary = ["cat","dog","sun","map","play","book","milk","jump","door"]; }

    // Populate Year Select
    const sel = document.getElementById('yearSelect');
    Object.keys(lessons).forEach(y => {
      const opt = document.createElement('option');
      opt.value = y;
      opt.textContent = y;
      sel.appendChild(opt);
    });
  }

  // ------------------ Audio Setup ------------------
  const sfx = {
    correct: new Audio('./assets/sfx/correct.mp3'),
    wrong: new Audio('./assets/sfx/wrong.mp3'),
    start: new Audio('./assets/sfx/start.mp3'),
    end: new Audio('./assets/sfx/end.mp3'),
    bgm: new Audio('./assets/music/background.mp3')
  };
  sfx.bgm.loop = true; sfx.bgm.volume = 0.2;

  const toggleMusic = document.getElementById('musicToggle');
  toggleMusic.addEventListener('click', () => {
    if (sfx.bgm.paused) { sfx.bgm.play(); toggleMusic.textContent = 'üîä Music On'; }
    else { sfx.bgm.pause(); toggleMusic.textContent = 'üîà Music Off'; }
  });

  // ------------------ Game Logic ------------------
  let currentWords = [], currentIndex = 0, timerInterval;
  let timeLeft = 0, totalTime = 0, score = 0, correct = 0;
  let startTime = 0, paused = false, elapsed = 0;

  const timerEl = document.getElementById('timer');
  const wpmEl = document.getElementById('wpm');
  const progressEl = document.getElementById('progressInner');
  const progressCountEl = document.getElementById('progressCount');
  const feedback = document.getElementById('feedback');
  const inputBox = document.getElementById('inputBox');
  const display = document.getElementById('wordDisplay');
  const scoreBoard = document.getElementById('scoreboard');
  const startBtn = document.getElementById('startBtn');
  const pauseBtn = document.getElementById('pauseBtn');
  const timerSelect = document.getElementById('timerSelect');

  startBtn.addEventListener('click', startSession);
  pauseBtn.addEventListener('click', togglePause);
  inputBox.addEventListener('input', checkTyping);

  function startSession() {
    const selectedYear = document.getElementById('yearSelect').value;
    if (!selectedYear) return alert('Select a Year first!');
    sfx.start.play(); sfx.bgm.play();

    const lesson = lessons[selectedYear];
    const customTime = parseInt(timerSelect.value || lesson.timer || 30);
    totalTime = customTime;
    timeLeft = customTime;
    currentWords = shuffle([...lesson.items]);
    currentIndex = 0; correct = 0; score = 0;
    paused = false;

    showWord();
    inputBox.value = '';
    inputBox.classList.remove('hidden');
    inputBox.focus();
    updateProgress();

    clearInterval(timerInterval);
    startTime = Date.now();
    timerEl.textContent = timeLeft;
    wpmEl.textContent = "0";
    timerInterval = setInterval(runTimer, 1000);
  }

  function runTimer() {
    if (paused) return;
    const now = Date.now();
    elapsed = Math.floor((now - startTime) / 1000);
    timeLeft = Math.max(totalTime - elapsed, 0);
    timerEl.textContent = timeLeft;
    progressEl.style.width = ((timeLeft / totalTime) * 100) + '%';
    if (timeLeft <= 0) {
      nextWord();
      startTime = Date.now();
    }
  }

  function showWord() {
    display.innerHTML = '';
    const word = currentWords[currentIndex];
    if (!word) return endSession();

    [...word].forEach((ch, i) => {
      const span = document.createElement('span');
      span.textContent = ch;
      span.className = 'tile';
      display.appendChild(span);
    });
    feedback.textContent = '';
  }

  function checkTyping() {
    if (paused) return;
    const typed = inputBox.value;
    const word = currentWords[currentIndex];
    const tiles = display.querySelectorAll('.tile');
    tiles.forEach((t, i) => {
      t.classList.remove('correct', 'wrong');
      if (typed[i]) {
        if (typed[i].toLowerCase() === word[i].toLowerCase()) t.classList.add('correct');
        else t.classList.add('wrong');
      }
    });

    if (typed.toLowerCase() === word.toLowerCase()) {
      sfx.correct.play();
      correct++; score += word.length;
      nextWord();
    }

    updateWPM();
  }

  function updateWPM() {
    const minutes = Math.max((elapsed || 1) / 60, 0.01);
    const wpm = (correct / minutes).toFixed(1);
    wpmEl.textContent = wpm;
  }

  function nextWord() {
    inputBox.value = '';
    currentIndex++;
    updateProgress();
    if (currentIndex < currentWords.length) {
      showWord();
      elapsed = 0;
      startTime = Date.now();
      timeLeft = totalTime;
    } else {
      endSession();
    }
  }

  function endSession() {
    clearInterval(timerInterval);
    sfx.end.play();
    inputBox.classList.add('hidden');
    feedback.textContent = 'üéâ Session Complete!';
    updateWPM();
    scoreBoard.textContent = `Words Correct: ${correct}/${currentWords.length}`;
  }

  function togglePause() {
    paused = !paused;
    pauseBtn.textContent = paused ? '‚ñ∂ Resume' : '‚è∏ Pause';
    if (!paused) startTime = Date.now() - (elapsed * 1000);
  }

  function updateProgress() {
    const pct = ((currentIndex / currentWords.length) * 100).toFixed(1);
    progressCountEl.textContent = pct + '%';
    progressEl.style.width = pct + '%';
  }

  function shuffle(arr) {
    return arr.sort(() => Math.random() - 0.5);
  }

  loadData();
</script>-->
</body>
</html>
