<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<title>SmartKids Pro - Mouse Practice</title>
<link href="https://cdn.jsdelivr.net/npm/tailwindcss@3.4.4/dist/tailwind.min.css" rel="stylesheet">
<style>
  body {
    font-family: 'Poppins', sans-serif;
    background-color: #0f172a;
    color: white;
    overflow-x: hidden;
  }
  /* Sidebar */
  #sidebar {
    position: fixed;
    top: 0;
    right: 0;
    height: 100%;
    width: 240px;
    background: #1e293b;
    box-shadow: -4px 0 8px rgba(0,0,0,0.4);
    transform: translateX(100%);
    transition: transform 0.4s ease;
    padding: 1rem;
    z-index: 50;
  }
  #sidebar.show { transform: translateX(0); }
  #toggleSidebar {
    position: fixed;
    top: 1rem;
    right: 1rem;
    background: #3b82f6;
    border-radius: 50%;
    padding: 0.75rem;
    cursor: pointer;
    z-index: 60;
    transition: all 0.3s ease;
  }
  #toggleSidebar:hover { background: #60a5fa; transform: scale(1.1); }
  .practice-btn {
    width: 100%;
    margin-bottom: 0.6rem;
    padding: 0.6rem;
    border-radius: 0.5rem;
    font-weight: 600;
    text-align: center;
    cursor: pointer;
    color: white;
    transition: transform 0.3s ease, background 0.3s ease;
  }
  .practice-btn:hover { transform: translateY(-3px); }
  .btn-blue { background: #2563eb; }
  .btn-green { background: #16a34a; }
  .btn-pink { background: #db2777; }
  .btn-yellow { background: #eab308; color: #1e293b; }
  #tooltip {
    position: fixed;
    top: 4rem;
    right: 1.5rem;
    background: #facc15;
    color: #1e293b;
    font-weight: 600;
    padding: 6px 10px;
    border-radius: 6px;
    font-size: 0.85rem;
    opacity: 0;
    pointer-events: none;
    transition: opacity 0.4s ease;
    z-index: 70;
  }
  #tooltip.show { opacity: 1; }
  #gameBoard {
    margin-top: 2rem;
    text-align: center;
    min-height: 80vh;
  }
  .target {
    position: absolute;
    width: 60px;
    height: 60px;
    border-radius: 50%;
    background: #ef4444;
    cursor: pointer;
    animation: fadeIn 0.3s ease;
  }
  @keyframes fadeIn {
    from { opacity: 0; transform: scale(0.5); }
    to { opacity: 1; transform: scale(1); }
  }
</style>
</head>

<body class="relative">
  <!-- üîô Header -->
  <header class="w-full bg-slate-800 py-3 px-5 flex justify-between items-center">
    <a href="index.html" class="home-btn bg-white text-blue-700 px-4 py-2 rounded-lg font-semibold hover:bg-blue-200 transition">üè† Home</a>
    <h1 class="text-2xl font-bold">SmartKids Pro: Mouse Practice</h1>
  </header>

  <!-- üß≠ Sidebar Toggle -->
  <div id="toggleSidebar" title="Open Menu">‚ò∞</div>
  <div id="tooltip">Menu</div>

  <!-- üìö Sidebar -->
  <aside id="sidebar">
    <h2 class="text-xl font-semibold mb-3 border-b border-slate-500 pb-2">Practices</h2>
    <div id="practiceButtons"></div>
  </aside>

  <!-- üïπÔ∏è Main Game Area -->
  <main id="gameBoard" class="flex flex-col items-center justify-center">
    <h2 class="text-2xl font-semibold mb-4">Select a Practice Mode</h2>
    <p class="text-slate-400 mb-4 max-w-md text-center">
      Use the sidebar menu to select a mouse activity. Practice your clicking, dragging, and reflex skills!
    </p>
  </main>

  <script>
  const sidebar = document.getElementById("sidebar");
  const toggleSidebar = document.getElementById("toggleSidebar");
  const tooltip = document.getElementById("tooltip");
  const practiceButtons = document.getElementById("practiceButtons");
  const gameBoard = document.getElementById("gameBoard");

  // üé® Sidebar toggle
  let tooltipTimeout;
  toggleSidebar.addEventListener("mouseenter", () => {
    tooltip.classList.add("show");
    clearTimeout(tooltipTimeout);
    tooltipTimeout = setTimeout(() => tooltip.classList.remove("show"), 2000);
  });
  toggleSidebar.addEventListener("click", () => {
    sidebar.classList.toggle("show");
  });

  // üß© Fetch JSON Data
  fetch("json-files/mouse_lessons.json")
    .then(res => res.json())
    .then(data => loadPractices(data))
    .catch(err => console.error("Error loading JSON:", err));

  function loadPractices(data) {
    const year = "Year 1"; // default demo year
    const lessons = data[year];
    let colors = ["btn-blue", "btn-green", "btn-pink", "btn-yellow"];
    let colorIndex = 0;

    for (const [mode, info] of Object.entries(lessons)) {
      const btn = document.createElement("div");
      btn.className = `practice-btn ${colors[colorIndex % colors.length]}`;
      colorIndex++;
      btn.textContent = mode;
      btn.addEventListener("click", () => {
        sidebar.classList.remove("show");
        startPractice(mode, info);
      });
      practiceButtons.appendChild(btn);
    }
  }

  // üéØ Sample Practice Game (Click Practice)
  function startPractice(mode, info) {
    gameBoard.innerHTML = `
      <h2 class="text-xl font-bold mb-2">${mode}</h2>
      <p class="text-slate-400 mb-4">${info.instructions}</p>
      <button id="startGame" class="bg-green-600 px-5 py-2 rounded hover:bg-green-500">Start Game</button>
      <div id="score" class="mt-3 text-lg"></div>
    `;

    const startBtn = document.getElementById("startGame");
    startBtn.addEventListener("click", () => {
      runClickPractice(info.levels[0]);
    });
  }

  // üïπÔ∏è Demo Game Logic (Click Practice Level 1)
  function runClickPractice(level) {
    let score = 0;
    let hits = 0;
    let totalTargets = level.targets || 10;
    let timeLeft = level.time || 15;

    gameBoard.innerHTML = `
      <h2 class="text-xl font-semibold mb-2">Click Practice - ${level.name}</h2>
      <div id="timer" class="text-lg mb-2">Time: ${timeLeft}s</div>
      <div id="score" class="text-lg mb-4">Score: 0</div>
      <div id="playArea" class="relative bg-slate-800 rounded-lg w-[90vw] h-[70vh] overflow-hidden"></div>
    `;

    const timerDisplay = document.getElementById("timer");
    const scoreDisplay = document.getElementById("score");
    const playArea = document.getElementById("playArea");

    const timer = setInterval(() => {
      timeLeft--;
      timerDisplay.textContent = `Time: ${timeLeft}s`;
      if (timeLeft <= 0) endGame();
    }, 1000);

    function spawnTarget() {
      if (hits >= totalTargets) return;
      const target = document.createElement("div");
      target.className = "target";
      const x = Math.random() * (playArea.clientWidth - 70);
      const y = Math.random() * (playArea.clientHeight - 70);
      target.style.left = x + "px";
      target.style.top = y + "px";
      playArea.appendChild(target);

      target.addEventListener("click", () => {
        score += 10;
        hits++;
        if (hits === 3) target.style.background = "#22c55e"; // change color after third hit
        scoreDisplay.textContent = `Score: ${score}`;
        target.remove();
        if (hits < totalTargets) setTimeout(spawnTarget, 600);
        else endGame();
      });

      setTimeout(() => {
        if (document.body.contains(target)) target.remove();
      }, 1500);
    }

    spawnTarget();

    function endGame() {
      clearInterval(timer);
      playArea.innerHTML = `<h3 class='text-2xl font-bold mt-10'>üéâ Well done! Your score: ${score}</h3>`;
    }
  }
  </script>
</body>
</html>
